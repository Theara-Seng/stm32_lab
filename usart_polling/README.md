# USART Polling Concept

When we want to exchange data between two devices, we have two alternatives: we can transmit it in parallel, that is using a given number of communication lines equal to the size
of each data word. A UART/USART is a device that translates a parallel sequence of bits (usually grouped in a byte) in a continuous stream of signals flowing on a single
wire.

## USART Transimission

In a synchronous transmission, the sender and the receiver share a common clock generated by one of the two devices (usually the
device that acts as the master of this interconnection system)

![stm32F407VGT6](https://github.com/Theara-Seng/stm32_lab/blob/main/usart_polling/image/data.png)

we have a typical timing diagram showing the Device A sending one byte ( 0b01101001 ) serially to the Device B using a common reference clock


In a synchronous transmission the transmission speed and duration are defined by the clock: its frequency determines how fast we can transmit a single byte on the communication channel


![stm32F407VGT6](https://github.com/Theara-Seng/stm32_lab/blob/main/usart_polling/image/st.png)

## USART VS UART


![stm32F407VGT6](https://github.com/Theara-Seng/stm32_lab/blob/main/usart_polling/image/usart_uart.png)

A Universal Synchronous Receiver/Transmitter interface is a device able to transmit data word serially using two I/Os, one acting as transmitter (TX) and one as receiver (RX), plus one additional
I/O as one clock line, while a Universal Asynchronous Receiver/Transmitter uses only two RX/TX. Traditional we refer to the first interface with the term USART and to the
second one with the term UART.

## STM32 USART Configuration

In this, we will use USART2 for transmit the data from the stm32 to the computer. So, we will need a USB-TO-TTL connect from computer to the USART2 pin of the stm32



![stm32F407VGT6](https://github.com/Theara-Seng/stm32_lab/blob/main/usart_polling/image/usb_to_ttl.jpg)


Then we need to enable the USART2 in the stm32 configuration and also set it to Asynchronous and see the pin of the USART2 as shown in the image below 



![stm32F407VGT6](https://github.com/Theara-Seng/stm32_lab/blob/main/usart_polling/image/usart2.png)

## Coding 

We want to transmit the **helloworld** from stm32 to the computer through serial communication, so in this case we will use a HAL Library Function of stm32

```sh
HAL_StatusTypeDef HAL_UART_Transmit(UART_HandleTypeDef *huart, uint8_t *pData, uint16_t Size, uint32_t Timeout);
```

And if we want to receive from the computer, we can use

```sh
HAL_StatusTypeDef HAL_UART_Receive(UART_HandleTypeDef *huart, uint8_t *pData, uint16_t Size, uint32_t Timeout);
```
So, in order to transmit the hello world, in this case, I use two separate function for transmit. Once is creating an unsigned integer 8 bit with the array msg which store the **world\n** and another is transmit **hello** is using in the funciton directly.

```sh
  /* USER CODE BEGIN 2 */
  uint8_t msg[6] = "world\n";
  /* USER CODE END 2 */
  
  while (1)
  {  
	HAL_UART_Transmit(&huart2, (uint8_t*)"hello", strlen("hello"), 100);
	HAL_UART_Transmit(&huart2, (uint8_t*)msg, strlen(msg), 100);
	HAL_Delay(1000);
  }
 ```

## View the data (cutecom)

cutecom is used to view the data on the computer, there are many application which you can also use to view it 


![stm32F407VGT6](https://github.com/Theara-Seng/stm32_lab/blob/main/usart_polling/image/Serial.png)

So, we can see **helloworld** data in the image above 
